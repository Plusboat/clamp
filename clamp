#!/bin/bash

SOURCE="${BASH_SOURCE[0]}"
while [ -h "$SOURCE" ]; do
  DIR="$( cd -P "$( dirname "$SOURCE" )" && pwd )"
  SOURCE="$(readlink "$SOURCE")"
  [[ $SOURCE != /* ]] && SOURCE="$DIR/$SOURCE"
done
DIR="$( cd -P "$( dirname "$SOURCE" )" && pwd )"

start() {
    php $DIR/clamp.php controller start
}
 
stop() {
    echo -en "\n"
    php $DIR/clamp.php controller stop
    exit $?
}

#if [ "$#" == "0" ]; then
#    trap stop SIGINT
#    start

#    while true; do read x; done
#else
    php $DIR/clamp.php "$@"
#fi

#exec 3< <(cat <<OPTS
#memory_limit = 128M
#max_execution_time=300
#max_input_time=-1
#upload_max_filesize=25M
#post_max_size=20M
#max_input_vars=10000
#pdo_mysql.default_socket=/Users/jide/Projects/Wordpress/.clamp/tmp/mysql.sock
#mysql.default_socket=/Users/jide/Projects/Wordpress/.clamp/tmp/mysql.sock
#mysqli.default_socket=/Users/jide/Projects/Wordpress/.clamp/tmp/mysql.sock
#OPTS
#)

#sudo httpd -d . -DFOREGROUND -f /dev/fd/3